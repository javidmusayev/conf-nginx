# Step 1
## Create user-defined network in docker
```
docker network create userdefined
```

# Step 2
## Run Nginx in named docker container
```
docker run -d /
-p 80:80 -p 443:443 /
--network=userdefined /
-v "/etc/letsencrypt:/etc/letsencrypt" /
--name nginx /
nginx
```

We need ***userdefined*** network for connecting to backend applications (containers) by their name (applications' containers should be in the same network).  
We need volume (*-v* argument) for mapping automatically generated LetsEncrypt certificates (they will be generated by **certbot** in another container) to Nginx directory.

# Step 3
## Install Vim in Nginx container
```
docker exec -it nginx bash  
apt update  
apt install vim
```

# Step 4
## Run backend applications in named containers
We should use same ***userdefined*** network which we used for Nginx container.
```
docker run -d --network=userdefined --name local3000 testimage 3000
docker run -d --network=userdefined --name local3001 testimage 3001
docker run -d --network=userdefined --name local3002 testimage 3002
```

# Step 5
## Configure Nginx as reverse proxy (/etc/nginx/conf.d/default.conf)
```
server {
  server_name your_app1_domain_name;

  location ~ {
    proxy_pass http://local3000:3000;
  }
}

server {
  server_name your_app2_domain_name;

  location ~ {
    proxy_pass http://local3001:3000;
  }
}

server {
  server_name your_app3_domain_name;

  location ~ {
    proxy_pass http://local3002:3000;
  }
}
```

# Step 6
## Configure Nginx for HTTPS connections (/etc/nginx/conf.d/default.conf)
```
server {
  listen 80;
  listen 443 ssl;
  server_name your_domain_name;
  
  ssl_certificate /etc/letsencrypt/live/your_domain_name/fullchain.pem;
  ssl_certificate_key /etc/letsencrypt/live/your_domain_name/privkey.pem;
  ssl_protocols TLSv1.2 TLSv1.1 TLSv1;
  
  location ~ {
    root   /usr/share/nginx/html;
    index  index.html index.htm;
  }
}
```
